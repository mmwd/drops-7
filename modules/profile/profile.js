(function(a){Drupal.behaviors.profileDrag={attach:function(c,d){var e=a("#profile-fields");var b=Drupal.tableDrag["profile-fields"];b.row.prototype.onSwap=function(g){var f=this;a("tr.category-message",e).each(function(){if(a(this).prev("tr").get(0)==f.element){if((f.method!="keyboard"||f.direction=="down")){f.swap("after",this)}}if(a(this).next("tr").is(":not(.draggable)")||a(this).next("tr").length==0){a(this).removeClass("category-populated").addClass("category-empty")}else{if(a(this).is(".category-empty")){a(this).removeClass("category-empty").addClass("category-populated")}}})};b.onDrop=function(){dragObject=this;if(a(dragObject.rowObject.element).prev("tr").is(".category-message")){var i=a(dragObject.rowObject.element).prev("tr").get(0);var h=i.className.replace(/([^ ]+[ ]+)*category-([^ ]+)-message([ ]+[^ ]+)*/,"$2");var g=a("select.profile-category",dragObject.rowObject.element);var f=a("select.profile-weight",dragObject.rowObject.element);var j=f[0].className.replace(/([^ ]+[ ]+)*profile-weight-([^ ]+)([ ]+[^ ]+)*/,"$2");if(!g.is(".profile-category-"+h)){g.removeClass("profile-category-"+j).addClass("profile-category-"+h);f.removeClass("profile-weight-"+j).addClass("profile-weight-"+h);g.val(g[0].options[h].value)}}}}}})(jQuery);