(function(a){Drupal.behaviors.fieldUIFieldOverview={attach:function(b,c){a("table#field-overview",b).once("field-overview",function(){Drupal.fieldUIFieldOverview.attachUpdateSelects(this,c)})}};Drupal.fieldUIFieldOverview={attachUpdateSelects:function(e,c){var d=c.fieldWidgetTypes;var b=c.fields;a(".widget-type-select",e).each(function(){this.initialValue=this.options[0].text});a(".field-type-select",e).each(function(){this.targetSelect=a(".widget-type-select",a(this).closest("tr"));a(this).bind("change keyup",function(){var g=this.options[this.selectedIndex].value;var f=(g in d?d[g]:[]);this.targetSelect.fieldUIPopulateOptions(f)});a(this).trigger("change",false)});a(".field-select",e).each(function(){this.targetSelect=a(".widget-type-select",a(this).closest("tr"));this.targetTextfield=a(".label-textfield",a(this).closest("tr"));this.targetTextfield.data("field_ui_edited",false).bind("keyup",function(f){a(this).data("field_ui_edited",a(this).val()!="")});a(this).bind("change keyup",function(k,h){var h=(typeof h=="undefined"?true:h);var g=this.options[this.selectedIndex].value;var j=(g in b?b[g].type:null);var i=(g in b?b[g].widget:null);var f=(j&&(j in d)?d[j]:[]);this.targetSelect.fieldUIPopulateOptions(f,i);if(h&&!this.targetTextfield.data("field_ui_edited")){this.targetTextfield.val(g in b?b[g].label:"")}});a(this).trigger("change",false)})}};jQuery.fn.fieldUIPopulateOptions=function(b,c){return this.each(function(){var e=false;if(b.length==0){b=[this.initialValue];e=true}var f=this.options[this.selectedIndex].text;var d="";jQuery.each(b,function(g,h){var i=((typeof c!="undefined"&&g==c)||(typeof c=="undefined"&&h==f));d+='<option value="'+g+'"'+(i?' selected="selected"':"")+">"+h+"</option>"});a(this).html(d).attr("disabled",e?"disabled":false)})};Drupal.behaviors.fieldUIDisplayOverview={attach:function(b,c){a("table#field-display-overview",b).once("field-display-overview",function(){Drupal.fieldUIOverview.attach(this,c.fieldUIRowsData,Drupal.fieldUIDisplayOverview)})}};Drupal.fieldUIOverview={attach:function(e,b,d){var c=Drupal.tableDrag[e.id];c.onDrop=this.onDrop;c.row.prototype.onSwap=this.onSwap;a("tr.draggable",e).each(function(){var h=this;if(h.id in b){var g=b[h.id];g.tableDrag=c;var f=new d[g.rowHandler](h,g);a(h).data("fieldUIRowHandler",f)}})},onChange:function(){var b=a(this);var f=b.closest("tr").get(0);var d=a(f).data("fieldUIRowHandler");var c={};c[d.name]=b.get(0);var e=d.getRegion();if(e!=d.region){a("select.field-parent",f).val("");a.extend(c,d.regionChange(e));d.region=e}Drupal.fieldUIOverview.AJAXRefreshRows(c)},onDrop:function(){var d=this;var f=d.rowObject.element;var c=a(f).data("fieldUIRowHandler");if(c!==undefined){var b=a(f).prevAll("tr.region-message").get(0);var e=b.className.replace(/([^ ]+[ ]+)*region-([^ ]+)-message([ ]+[^ ]+)*/,"$2");if(e!=c.region){refreshRows=c.regionChange(e);c.region=e;Drupal.fieldUIOverview.AJAXRefreshRows(refreshRows)}}},onSwap:function(b){var c=this;a("tr.region-message",c.table).each(function(){if(a(this).prev("tr").get(0)==c.group[c.group.length-1]){if((c.method!="keyboard"||c.direction=="down")){c.swap("after",this)}}if(a(this).next("tr").is(":not(.draggable)")||a(this).next("tr").length==0){a(this).removeClass("region-populated").addClass("region-empty")}else{if(a(this).is(".region-empty")){a(this).removeClass("region-empty").addClass("region-populated")}}})},AJAXRefreshRows:function(e){var c=[];var b=[];a.each(e,function(g,f){c.push(g);b.push(f)});if(c.length){var d=a('<div class="ajax-progress ajax-progress-throbber"><div class="throbber">&nbsp;</div></div>');a(b).addClass("progress-disabled").after(d);a("input[name=refresh_rows]").val(c.join(" "));a("input#edit-refresh").mousedown();a(b).attr("disabled",true)}}};Drupal.fieldUIDisplayOverview={};Drupal.fieldUIDisplayOverview.field=function(c,b){this.row=c;this.name=b.name;this.region=b.region;this.tableDrag=b.tableDrag;this.$formatSelect=a("select.field-formatter-type",c);this.$formatSelect.change(Drupal.fieldUIOverview.onChange);return this};Drupal.fieldUIDisplayOverview.field.prototype={getRegion:function(){return(this.$formatSelect.val()=="hidden")?"hidden":"visible"},regionChange:function(e){var b=this.$formatSelect.val();switch(e){case"visible":if(b=="hidden"){var d=(this.defaultFormatter!=undefined)?this.defaultFormatter:"visible"}break;default:var d="hidden";break}if(d!=undefined){this.$formatSelect.val(d)}var c={};c[this.name]=this.$formatSelect.get(0);return c}}})(jQuery);